apply plugin: 'java'
apply plugin: 'eclipse'
apply plugin: 'maven-publish'
apply plugin: 'com.github.johnrengelman.shadow'

version = '1.0'

publishing {
    publications {
        maven(MavenPublication) {
            groupId 'com.altran.gossip'
            artifactId 'gossip-backend'
            version project.version

            from components.java
        }
    }
}

shadowJar {
  mergeServiceFiles()
}

jar {
    manifest {
        attributes 'Implementation-Title': 'Altran Gossip-Backend', 
                   'Implementation-Version': version, 
                   'Main-Class': 'com.altran.gossip.backend.BackendService'
    }
    print "Version: " + project.version
}

dependencies {
    compile libraries.jackson_core
    compile libraries.jackson_databind
    compile libraries.dropwizard_core
    compile libraries.eclipse_paho
    compile libraries.hibernate_core
    compile libraries.mysql_connector
    compile libraries.slf4j_api
  	compile project(':gossip-library')
    // test 
    testCompile libraries.junit
    testCompile libraries.hamcrest_junit
    testCompile libraries.jmockit
    testCompile group: 'org.apache.derby', name: 'derby', version: '10.14.1.0'
}